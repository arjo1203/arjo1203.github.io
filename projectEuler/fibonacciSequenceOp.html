<html>
<head>
    <link href="../bootStrap/bootstrap.min.css" rel="stylesheet" >
</head>
<body>
<div id="alert" class="alert alert-danger alert-dismissible fade in" role="alert">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">x</span>
    </button>
    <h4 id="header"></h4>
    <p id="alertMessage"></p>
    <div id="strings">
    </div>
</div>
<!--Sending to others use commented links-->
<!--<script src="//code.jquery.com/jquery-2.1.3.min.js"></script>-->
<!--<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>-->
<script src="../assets/plugins/jquery-1.11.2.min.js"></script>
<script src="../bootStrap/bootstrap.js"></script>
<script>
    var container = ['1', '1'], numOfExecutions = 0;
    var start = new Date().getTime(), lengthOfDigit = 2;
    var header = $('#header'), message = $('#alertMessage'), div = $('#strings');
    header[0].innerHTML = 'Computing the first ' + lengthOfDigit + ' long digit term of the Fibonacci Sequence.';
    console.log(container);


    while(container[0].length < lengthOfDigit || container[1].length < lengthOfDigit){
        container = addTwoIndices(container);
        console.log(container);

        if(container[0].length == lengthOfDigit){
            var time = (new Date().getTime()) - start;
            message[0].innerHTML = 'It takes ' + numOfExecutions + ' executions to obtain the first term in the Fibonacci sequence to contain ' + lengthOfDigit + ' digits!' +
            ' Execution time: ' + time / 1000 + ' seconds!';
            div[0].innerHTML = 'The first term to be ' + lengthOfDigit + ' digit is ' + container[0];
        }
    }

    function addTwoIndices(array){
        var num1, num2, newArray;
        num1 = addHugeNumbers(array[0], array[1]);
        num2 = addHugeNumbers(array[1], num1);

        newArray = [num1, num2];
        return newArray;
    }

    function addHugeNumbers(a, b){
        var carry = 0, maxNum, minNum, numSum = '';

        var results = findMax(a, b);
        console.log(typeof results.max, typeof results.min);
        maxNum = results.max;
        minNum = results.min;

        maxNum = '0' + maxNum;//Gives an extra place in case of overflow
        minNum = makeSameLength(maxNum, minNum);//Make the strings the same length

        //Adds strings starting with least significant to most significant
        for(var i = maxNum.length - 1; i > -1; i--){
            var x = parseInt(maxNum[i]);
            var y = parseInt(minNum[i]);
            var sum = x + y + carry;

            if(sum > 9){
                carry = 1;
                sum = sum % 10;
            }
            else{
                carry = 0;
            }

            var s = sum.toString();
            numSum = s + numSum;
        }

        numSum = removeLeadingZeros(numSum);//Removes added zeros if no overflow occurred

        numOfExecutions++;//Tracks Fibonacci term

        return numSum;
    }


    function findMax(a, b){
        console.log('hello');
        console.log(typeof a, typeof b);
        var number = {}, max, min;
        if(a.length == b.length){//If lengths of the strings are the same, findMax determines the larger number
            max = getMax(a, b);
            if (max == a){//After determining the larger number, use that number to check when is the minNum
                min = b;
            }
            else {
                min = a;
            }
        }
        else if(a.length >= b.length){//If one string is longer than the other, than that string contains a larger number
            max = a;
            min = b;
        }
        else if(a.length <= b.length){//If one string is longer than the other, than that string contains a larger number
            max = b;
            min = a;
        }
        number.max = max;
        number.min = min;

        return number;
    }


    //getMax() assumes the strings are the same length
    //Checks digit by digit, starting with most significant to least
    function getMax(string1, string2){
        var max, found = false, equalityCheck = 0;

        var i = 0;
        while(!found){
            if(string1[i] > string2[i]){
                max = string1;
                found = true;
            }
            else if(string1[i] < string2[i]){
                max = string2;
                found = true;
            }
            else if(string1[i] == string2[i]){
                equalityCheck++;

                if(equalityCheck == string1.length){//numbers are equal
                    return string1;
                    found = true;
                }
            }

            i++;
        }

        return max;
    }


    //findMax() assumes the strings are the same length
    //Checks digit by digit, starting with most significant to least
    function findMax(string1, string2){
        var max, found = false, equalityCheck = 0;

        var i = 0;
        while(!found){
            if(string1[i] > string2[i]){
                max = string1;
                found = true;
            }
            else if(string1[i] < string2[i]){
                max = string2;
                found = true;
            }
            else if(string1[i] == string2[i]){
                equalityCheck++;

                if(equalityCheck == string1.length){//numbers are equal
                    return string1;
                    found = true;
                }
            }

            i++;
        }

        return max;
    }


    //Makes the strings the same length by leading zeros to the smaller number
    function makeSameLength(max, min){
        console.log(typeof max, typeof min);
        var zero = '0';

        var i = 0;

        while(max.length != min.length){
            min = zero + min;
        }

        return min;
    }


    //Removes any leading zeros from string
    function removeLeadingZeros(string){
        var num, leadingZeros = true, zeros = 0, i = 0;

        while(leadingZeros){
            if(string[i] == '0'){
                zeros++;
            }
            else{
                leadingZeros = false
            }

            i++;
        }


        num = string.slice(zeros);

        return num;
    }
</script>
</body>
</html>